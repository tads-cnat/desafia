name: Build and Publish image to Docker Hub
on: [workflow_dispatch]

jobs:
  deploy:
    name: Build and Publish image to Docker Hub
    runs-on: ubuntu-latest
    steps:
      - name: Check out repository
        uses: actions/checkout@v3

      - name: Set up Docker
        uses: docker/setup-buildx-action@v2

      - name: Docker Compose Build and Up
        working-directory: /home/runner/work/desafia
        run: sudo docker compose -f ./frontend/docker-compose.yml up -d --build

      - name: Docker login
        run: sudo docker login -u maaaure -p ${{ secrets.DOCKER_HUB_TOKEN }}

      - name: Push image to registry
        run: sudo docker compose push maaaure/desafia-frontend:latest
